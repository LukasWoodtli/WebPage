{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/enums",
    "result": {"data":{"site":{"siteMetadata":{"title":"My personal Website"}},"markdownRemark":{"id":"5784cfb4-e087-5afb-8726-efc77bfdb621","excerpt":"Enums in C and C++ are a very simple construct. It’s just a collection of identifiers that have (usually) distinctive values.\nBy default the values increase by…","html":"<p>Enums in C and C++ are a very simple construct. It’s just a collection of identifiers that have (usually) distinctive values.\nBy default the values increase by one in the stated order. But the values can defined by the programmer.\nEven if enums are a simple language construct there are special precautions that need to be taken when using them:</p>\n<ul>\n<li>Is a enum continuous (i.e. can I iterate over it?)</li>\n<li>Have the enum values meaning outside of my software or module</li>\n<li>what is the size (in Bytes) of an enum variable</li>\n</ul>\n<h1 id=\"iterating-over-enums\">Iterating over enums</h1>\n<p>Be careful if you iterate over an enum. If the enum is not continuously defined your code is probably doing some things you don’t want it to do.\nFor exampe:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">enum</span>\n<span class=\"token punctuation\">{</span>\n  VAL_1 <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n  VAL_2 <span class=\"token operator\">=</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n  VAL_3 <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n  VAL_NB\n<span class=\"token punctuation\">}</span> <span class=\"token class-name\">my_enum_t</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> enum_var<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>enum_var <span class=\"token operator\">=</span> VAL_1<span class=\"token punctuation\">;</span> enum_var <span class=\"token operator\">&lt;</span> VAL_NB<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>enum_var<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%i\\n\"</span><span class=\"token punctuation\">,</span>enum_var<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">printf</code> is called 11 times with the values 10 to 20. That’s usually not what we want.</p>\n<p>So what’s the solution? Don’t iterate over enums that have fixed values assigned. If you have to do it there is a trick called <strong>X Macros</strong>\nthat I’ll cover in another post.</p>\n<p>There is one exception. You can assign a value to the first enum type:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">enum</span>\n<span class=\"token punctuation\">{</span>\n    VAL_1 <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    VAL_2<span class=\"token punctuation\">,</span>\n    VAL_3<span class=\"token punctuation\">,</span>\n    VAL_NB\n<span class=\"token punctuation\">}</span> <span class=\"token class-name\">my_enum_t</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>If you call the same loop as above you’ll get calls to <code class=\"language-text\">printf</code> with the values:</p>\n<blockquote>\n<p>10 (VAL_1), 11 (VAL_2) and 12 (VAL_3).</p>\n</blockquote>\n<h1 id=\"enums-with-fixed-values\">Enums with fixed values</h1>\n<p>If you don’t need to iterate over your enum it’s usually a good practice to assign a defined value to your enum fields. This is even mandatory if your enum has a meaning across your software (or module) or even different versions of the same software. Add defined values to your enums if:</p>\n<ul>\n<li>the value can be saved to a file</li>\n<li>the value is sent (or received) over a physical interface</li>\n<li>the value is needed in an other software (or library…) or a different version of the same software (i. e. feature release)</li>\n</ul>\n<p>But if you do so, don’t iterate over your enum!</p>\n<p>If you serialize/deserialize your values (i.e. save into a file, send over an interface) be careful about the enum size and the endianness of\nthe used platform.</p>\n<h1 id=\"size-and-endianness\">Size and endianness</h1>\n<p>The size (and endianness) of a enum variable depends on the compiler and on the target platform. So if you write platform independent code (and you should always do that) take care of this.\nThere are some language extension in different compilers to address this topic. For example in Visual Studio:</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">typedef</span> <span class=\"token keyword\">enum</span> <span class=\"token operator\">:</span> <span class=\"token class-name\">uint8_t</span>\n<span class=\"token punctuation\">{</span> VAL_1<span class=\"token punctuation\">,</span> VAL2<span class=\"token punctuation\">,</span> <span class=\"token comment\">/* … */</span><span class=\"token punctuation\">,</span> VAL_NB<span class=\"token punctuation\">}</span> <span class=\"token class-name\">my_enum_t</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>For platform independent code you can do: <code class=\"language-text\">#define ENUM_AS_UINT8 : uint8_t</code></p>\n<h1 id=\"romable-values\">Romable values</h1>\n<p>Another use of enums is mainly used in embedded systems development. In embedded systems you are often concerned that a constant is stored in the program flash. Otherwise it has to be loaded from RAM at runtime (and even stored there at start time). The usual way is to use defines.\nBut they are not really type safe. So for int-types it’s possible to use enums. If your compiler(s) support it you can even use anonymous enums.</p>\n<h1 id=\"advanced-enum-constructs-c11-qt\">Advanced enum constructs (C++11, Qt)</h1>\n<p>C++11 introduces the enum class. And Qt some extensions for enums (Q_ENUMS) that I’ll not cover here. If you can use one of this advanced enum constructs then do it!</p>\n<h1 id=\"conclusion\">Conclusion</h1>\n<ul>\n<li>If you have to iterate over your enum: don’t add explicit values to your enum, but add and {identifier}_NB value to the end (or something similar) to check when the iteration is finished</li>\n<li>If your enum value is meaningful (serialization…): assign a defined value and take care about endianness and size of the enum variables</li>\n<li>Use (anonymous) enums to make values Romable</li>\n<li>Use an advanced enum type (C++11, Qt) if you can</li>\n<li>If you need fixed enum values and you want to iterate over the values you need two enums. Use X Macros for it (there is going to be a feature post on that)</li>\n</ul>\n<h1 id=\"references\">References</h1>\n<p><a href=\"http://en.wikipedia.org/wiki/Endianness\">Endianness (Wikipedia)</a><br>\n<a href=\"http://stackoverflow.com/questions/7147008/the-usage-of-anonymous-enums\">The usage of anonymous enums (Stack Overflow)</a></p>","frontmatter":{"title":"Enums in C and C++","tags":["C","C++"],"category":"Programming"},"headings":[{"depth":1,"value":"Iterating over enums"},{"depth":1,"value":"Enums with fixed values"},{"depth":1,"value":"Size and endianness"},{"depth":1,"value":"Romable values"},{"depth":1,"value":"Advanced enum constructs (C++11, Qt)"},{"depth":1,"value":"Conclusion"},{"depth":1,"value":"References"}]}},"pageContext":{"id":"5784cfb4-e087-5afb-8726-efc77bfdb621","previousPost":{"title":"Intro to SQL","slug":"/blog/sql_introduction"},"nextPost":{"title":"Harmful C Functions and their replacements","slug":"/blog/harmful_c_functions"},"dates":{"created":1429200045,"modified":1647509701}}},
    "staticQueryHashes": []}